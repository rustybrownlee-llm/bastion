# POC-001.0: Basic Go Project Structure

**Status**: Proposed
**Created**: 2025-01-28
**References**: DD-001 Bastion Architecture

---

## 1. Objective

Establish the foundational Go project structure for the Bastion POC, including module initialization, directory layout, and a minimal runnable binary that proves the development environment is working.

---

## 2. Scope

### In Scope
- Go module initialization (`go.mod`)
- POC directory structure following Go conventions
- Minimal main.go that starts an HTTP server
- Basic health check endpoint
- README documenting POC purpose and constraints

### Out of Scope
- Authentication logic (POC-002)
- Database connectivity (POC-002)
- RBAC implementation (POC-003)
- Production-grade error handling
- Configuration management beyond basics

---

## 3. Deliverables

### Directory Structure

```
poc/
├── cmd/
│   └── bastion/
│       └── main.go           # Entry point
├── internal/
│   └── server/
│       └── server.go         # HTTP server setup
├── go.mod                    # Module definition
├── go.sum                    # Dependencies (after first build)
└── README.md                 # POC documentation
```

### Files to Create

#### 3.1 `poc/go.mod`

```go
module github.com/your-org/bastion/poc

go 1.24
```

Note: Replace `your-org` with actual organization name.

#### 3.2 `poc/cmd/bastion/main.go`

Minimal entry point that:
- Starts HTTP server on configurable port (default 8080)
- Registers health check endpoint
- Handles graceful shutdown on SIGINT/SIGTERM
- Logs startup and shutdown events

#### 3.3 `poc/internal/server/server.go`

HTTP server setup that:
- Creates chi router
- Registers `/health` endpoint returning `{"status": "ok"}`
- Returns configured `http.Server`

#### 3.4 `poc/README.md`

Documents:
- POC purpose (throwaway code to validate architecture)
- How to build and run
- What this POC does NOT include (not production code)

---

## 4. Technical Approach

### 4.1 Dependencies

Only approved dependencies:
- `github.com/go-chi/chi/v5` - HTTP routing

All other functionality uses Go standard library.

### 4.2 Server Implementation

```
main.go
  │
  ├── Parse flags (--port)
  ├── Create server (internal/server)
  ├── Start HTTP listener
  └── Wait for shutdown signal
          │
          └── Graceful shutdown with timeout
```

### 4.3 Health Endpoint

```
GET /health

Response: 200 OK
{
  "status": "ok",
  "timestamp": "2025-01-28T10:30:00Z"
}
```

---

## 5. Success Criteria

1. `go build ./cmd/bastion` succeeds without errors
2. Binary starts and listens on specified port
3. `curl http://localhost:8080/health` returns 200 with JSON response
4. SIGINT (Ctrl+C) triggers graceful shutdown
5. Code follows Go conventions (gofmt, no lint errors)

---

## 6. Dependencies

- None (this is the first POC)

---

## 7. Validation Steps

After implementation:

```bash
cd poc
go mod tidy
go build ./cmd/bastion
./bastion --port 8080 &
curl -s http://localhost:8080/health | jq .
kill %1
```

Expected output:
```json
{
  "status": "ok",
  "timestamp": "2025-01-28T..."
}
```

---

## 8. Estimated Effort

Minimal - establishes foundation only.

---

## 9. Notes

This SOW intentionally keeps scope minimal. The goal is a working starting point, not a complete application. Subsequent SOWs will add authentication (POC-002) and RBAC (POC-003).

---

## Approval

- [ ] SOW Reviewed
- [ ] SOW Approved

**Approved By**: _______________
**Date**: _______________
